process {
    if ( params.callPeaks ) {
        withName: '.*CISTOPIC_CALLPEAKS' {
            ext.outputdir = "narrowPeaks"
            ext.args      = {
                [
                    "--specie hs",
                    "--input_format BEDPE",
                    "--shift 73",
                    "--extend_read_size 146",
                    "--keep_duplicates all",
                    "--q_value_cutoff 0.05"
                ].join(' ')
            }
            cpus       = 4
            memory     = { 16.GB + 16.GB * (task.attempt - 1) }
            publishDir = [
                mode     : params.publish_mode,
                path     : { "${params.output_dir}/pseudobulk" },
                overwrite: true
            ]
        }
    }
}